1.BOOK (Book_id, Title, Publisher_Name, Pub_Year) BOOK_AUTHORS (Book_id, Author_Name) PUBLISHER (Name, Address, Phone) BOOK_COPIES (Book_id, Branch_id, No-of_Copies) BOOK_LENDING (Book_id, Branch_id, Card_No, Date_Out, Due_Date) LIBRARY_BRANCH (Branch_id, Branch_Name, Address)
Write SQL queries to
List of books with more than 5 copies.
List of books with pub_Year 1991 
Get the particulars of borrowers who have borrowed more than 3 books.
Delete a book in BOOK table. Update the contents of other tables to reflect this data manipulation operation.
Create a view of all books and its number of copies that are currently available in the Library.

1-BOOK.TXT

CREATE BOOK(
BOOK_ID INT PRIMARY KEY,
TITLE VARCHAR(100),
PUBLISHER_NAME VARCHAR(100),
PUB_YEAR INT );

CREATE TABLE BOOK_AUTHORS(
BOOK_ID INT ,
AUTHOR_NAME VARCHAR(100)
);

CREATE TABLE PUBLISHER(
PUBLISHER_NAME VARCHAR(100),
PUB_ADDRESS VARCHAR(100),
PUB_PHONE VARCHAR(100)
);

CREATE TABLE BOOK_COPIES(
BOOK_ID INT,
BRANCH_ID INT,
NO_OF_COPIES INT
);

CREATE TABLE BOOK_LENDING (
BOOK_ID INT,
BRANCH_ID INT,
CARD_NO INT,
DATE_OUT DATE,
DUE_DATE DATE
);

CREATE TABLE LIBRARY_BRANCH (
BRANCH_ID INT,
BRANCH_NAME VARCHAR(100),
BRANCH_ADDRESS VARCHAR(100)
);
 
ALTER TABLE LIBRARY_BRANCH
ADD CONSTRAINT
PRIMARY KEY (BRANCH_ID);

ALTER TABLE BOOK_LENDING
ADD CONSTRAINT
PRIMARY KEY (BOOK_ID,BRANCH_ID,CARD_NO);

ALTER TABLE BOOK_COPIES
ADD PRIMARY KEY (BOOK_ID, BRANCH_ID);

ALTER TABLE PUBLISHER
ADD PRIMARY KEY (PUBLISHER_NAME);

ALTER TABLE PUBLISHER
ADD PRIMARY KEY (PUBLISHER_NAME);

ALTER TABLE BOOK
ADD CONSTRAINT 
FOREIGN KEY(PUBLISHER_NAME) REFERENCES PUBLISHER(PUBLISHER_NAME)
ON DELETE CASCADE
ON UPDATE CASCADE;

ALTER TABLE BOOK_AUTHORS
ADD CONSTRAINT
FOREIGN KEY(BOOK_ID) REFERENCES BOOK(BOOK_ID)
ON DELETE CASCADE
ON UPDATE CASCADE;

ALTER TABLE BOOK_LENDING
ADD CONSTRAINT
FOREIGN KEY(BOOK_ID) REFERENCES BOOK(BOOK_ID)
ON DELETE CASCADE
ON UPDATE CASCADE;

ALTER TABLE BOOK_LENDING
ADD CONSTRAINT
FOREIGN KEY(BRANCH_ID) REFERENCES LIBRARY_BRANCH (BRANCH_ID)
ON DELETE CASCADE
ON UPDATE CASCADE;

ALTER TABLE BOOK_COPIES
ADD CONSTRAINT
FOREIGN KEY(BOOK_ID) REFERENCES BOOK(BOOK_ID)
ON DELETE CASCADE
ON UPDATE CASCADE;

ALTER TABLE BOOK_COPIES
ADD CONSTRAINT
FOREIGN KEY(BRANCH_ID) REFERENCES LIBRARY_BRANCH(BRANCH_ID)
ON DELETE CASCADE
ON UPDATE CASCADE;

INSERT INTO BORROWER VALUES
('1' , 'BRWER1' , 'BRWERADD1' , '09876'),
('2' , 'BRWER2' , 'BRWERADD2' , '55674'),
('3' , 'BRWER3' , 'BRWERADD3' , '68436');

INSERT INTO PUBLISHER VALUES
('PUBLISHERA' , 'addressofpuba' ,'123345'),
('PUBLISHERB' , 'addressofpubb' ,'123545'),
('PUBLISHERC' , 'addressofpubc' ,'123445');

INSERT INTO LIBRARY_BRANCH VALUES 
('1' , 'BRANCHNO1' ,'ADDBRANCH1'),
('2' , 'BRANCHNO2' ,'ADDBRANCH2'),
('3' , 'BRANCHNO3' ,'ADDBRANCH3');

INSERT INTO BOOK VALUES
('001' , 'BOOKEX1' , 'PUBLISHERA' ,'1991'),
('002' , 'BOOKEX2' , 'PUBLISHERB' ,'1992'),
('003' , 'BOOKEX3' , 'PUBLISHERC' ,'1996'),
('004' , 'BOOKEX4' , 'PUBLISHERA' ,'1991');

INSERT INTO BOOK_AUTHORS VALUES
('001' , 'AUTHOR_A'),
('002' , 'AUTHOR_B'),
('003' , 'AUTHOR_B'),
('004' , 'AUTHOR_C');

INSERT INTO BOOK_COPIES VALUES
('001' , '1' , '5'),
('002' , '1' , '6'),
('003' , '2' , '2'),
('004' , '3' , '6');

INSERT INTO BOOK_LENDING VALUES
('001', '1' , '1' , '2025-10-27', '2025-10-31'),
('002', '1' , '1' , '2025-10-29', '2025-11-01'),
('003', '1' , '1' , '2025-10-29', '2025-11-02');

SELECT
B.BOOK_ID , B.TITLE, B.PUBLISHER_NAME , BC.NO_OF_COPIES
FROM
BOOK B
JOIN 
BOOK_COPIES BC
ON
B.BOOK_ID = BC.BOOK_ID
WHERE BC.NO_OF_COPIES > 5;

SELECT
B.BOOK_ID , B.TITLE , B.PUBLISHER_NAME
FROM BOOK B
WHERE B.PUB_YEAR = 1991;

SELECT
BRW.CARD_NO , BRW.NAME , BRW.ADDRESS , BRW.PHONE , COUNT(BKL.BOOK_ID) AS TOTAL_BOOKS_BORROWED
FROM BORROWER BRW 
JOIN BOOK_LENDING BKL
ON BRW.CARD_NO = BKL.CARD_NO
GROUP BY 
BRW.CARD_NO , BRW.NAME , BRW.ADDRESS , BRW.PHONE
HAVING COUNT(BKL.BOOK_ID)>2;

DELETE FROM BOOK WHERE TITLE = ‘BOOKEX2’;

CREATE VIEW AVAILABLE_BOOKS3 AS
SELECT 
B.BOOK_ID , B.TITLE , B.PUBLISHER_NAME , SUM(BC.NO_OF_COPIES) AS TOTAL_COPIES
FROM
BOOK B
JOIN 
BOOK_COPIES BC
ON B.BOOK_ID = BC.BOOK_ID
GROUP BY B.BOOK_ID , B.TITLE , B.PUBLISHER_NAME;
